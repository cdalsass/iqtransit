package com.iqtransit.agency;
import java.util.Properties; 
import java.lang.IllegalArgumentException;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.ArrayList;
import java.sql.Statement;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Types; 
import java.util.Date;
import java.util.TimeZone;
import com.iqtransit.gtfs.GtfsDate;

public class MBTAAgency implements AgencyInterface {

	private Properties config;
	private Connection conn; 
	
	public TimeZone getTimeZone() {
		return TimeZone.getTimeZone("America/New_York");
	}

	public boolean isServiceRunningNow(String service_id, long reference_time_seconds) throws SQLException {
		
		if (this.conn == null) {
			throw new SQLException("connection missing from MBTAAgency. be sure to call assignConnection()");
		}

		TimeZone tz = this.getTimeZone();

		GtfsDate date = new GtfsDate();

		String sql = "select exception_type from calendar_dates where service_id = ? and date = '" + date.fromUnix(reference_time_seconds,tz) + "'";	
		PreparedStatement stmt = conn.prepareStatement(sql);
        stmt.setString(1, service_id);


		return true;
	}

	public String[] getServicesIdsFromShortName(String trip_short_name) throws SQLException {
		
		if (this.conn == null) {
			throw new SQLException("connection missing from MBTAAgency. be sure to call assignConnection()");
		}

		ArrayList service_list = new ArrayList<String>();

		String sql = "select service_id from trips where trip_short_name = ?";

        PreparedStatement stmt = conn.prepareStatement(sql);
        stmt.setString(1, trip_short_name);

        ResultSet results = stmt.executeQuery();

        while (results.next())  {
        	service_list.add(results.getString("service_id"));
        }

		return (String[]) service_list.toArray(new String[service_list.size()]);
	}

	public MBTAAgency(Properties config) {
		this.config = config;
	}

	public void assignConnection(Connection conn) {
		this.conn = conn;
	}

	// this is possible, but you have to make sure you don't need config.
	public MBTAAgency() {

	}

	private int LineNumber(String line_name) {

		/* copied from tontime.js */
		int line_number = 0; 
		switch (line_name) {

			case "Greenbush" : 
				line_number = 1;
				break;
			case "Fairmount":       
				 line_number = 4;
				 break;
			case "Fitchburg":   
				line_number = 9;
				break;
			case "Worcester"  :  
				 line_number = 8;
				 break;
			case "Franklin"  :    
				line_number = 6;
				break;
			case "Haverhill" :     
				 line_number = 11;
				 break;
			case "Lowell" : 
				 line_number = 10;
				 break;
			case "Middleborough" :  
				line_number = 3;
				break;
			case "Needham":
				line_number = 7;
				break;
			case "Newburyport"   : 
				line_number = 12;
				break;
			case "Kingston/Plymouth"      : 
				line_number = 2;
				break;
			case "Providence"   : 
				line_number = 5;
				break;
			default: 
			 	System.out.println("Invalid line name.");
                break;

        }
		return line_number;
	}

	public String VehiclePositionUrl() {
		return  "http://developer.mbta.com/lib/GTRTFS/Alerts/VehiclePositions.pb";
	}


	public String ServiceAlertUrl(String format) throws IllegalArgumentException {
		if (format.equals("GTFSRT")) {
			return "http://developer.mbta.com/lib/GTRTFS/Alerts/Alerts.pb";
		} else if (format.equals("MBTA_V2")) {

			String api_key = null;
			try {
				api_key = config.getProperty("api_key");
			} catch (Exception e) {
				System.out.println("Error: api_key not defined in properties");
				throw e; 
			}
			
			return "http://realtime.mbta.com/developer/api/v2/alerts?api_key=" + config.getProperty("api_key") + "&format=json";
			 
		} else {
			throw new IllegalArgumentException();
		}
		
	}

	public String TripUpdatesUrl() {
		return "http://developer.mbta.com/lib/GTRTFS/Alerts/TripUpdates.pb";
	}

	public String RealtimeSource(String line_name, String format) {
		if (format.equals("json")) {
			int rail_id = LineNumber(line_name);
			return "http://developer.mbta.com/lib/RTCR/RailLine_" + rail_id + ".json";
		} else if (format.equals("gtfs-realtime")) {
			return "http://developer.mbta.com/lib/GTRTFS/Alerts/VehiclePositions.pb";
		} else {
			throw new Error("invalid format " + format);
		}
	}

	public String[] getLines() {

		String[] results = {
			"Greenbush",
			"Fairmount",
			"Fitchburg", 
			"Worcester",
			"Franklin",
			"Haverhill",
			"Lowell",
			"Middleborough", 
			"Needham",
			"Newburyport", 
			"Kingston/Plymouth",
			"Providence"
		};

		return results;

	}

	public double[][] getLinePaths(String lineid) {
		// just trying to get some data to try this out in android. to see if things crash or not.  
		// get line path suitable for drawing on map. don't really care about direction of train at this point, so arbitrarily chose a trip id. 
		// grep 9840001 ../../working/2014_11_30_research_GTFS_paths/MBTA_GTFS/shapes.txt | perl -ne '@a = split(/,/); $a[1] =~s/"//g; $a[2] =~ s/"//g; print "$a[1],$a[2],"'
		double[][] results =  { 
			{
				42.58088675,-71.79310371,42.58088675,-71.79310371,42.58080088,-71.79288276,42.58070509,-71.79267736,42.58059092,-71.79246817,42.58046658,-71.79226969,42.58033617,-71.7920801,42.58013457,-71.79183412,42.57952316,-71.79120827,42.57881725,-71.79051516,42.57863874,-71.79035915,42.57844567,-71.79020974,42.57824653,-71.79007145,42.57804379,-71.78994763,42.57787636,-71.78985887,42.57770644,-71.78977863,42.57753568,-71.78970656,42.57730404,-71.78961862,42.57713844,-71.78956477,42.57693745,-71.78950852,42.57676469,-71.789468,42.57641554,-71.78940588,42.57592727,-71.78934721,42.57590944,-71.78934602,42.57549447,-71.78927171,42.57535216,-71.78923245,42.57531103,-71.7892215,42.57526744,-71.78920682,42.57505746,-71.78912269,42.5749418,-71.78906907,42.57478177,-71.78898369,42.57462341,-71.78888904,42.57446864,-71.78878363,42.57431035,-71.78866225,42.57415565,-71.788529,42.57400619,-71.78838613,42.57385595,-71.78822395,42.57371124,-71.78804954,42.57340491,-71.78765164,42.57329226,-71.78749186,42.5729601,-71.78699993,42.57271524,-71.78659973,42.57259203,-71.78637976,42.57235965,-71.78592653,42.57223655,-71.78566313,42.57212115,-71.78539383,42.57191308,-71.78487092,42.57173351,-71.7843604,42.57156309,-71.78381354,42.57148695,-71.78353476,42.57138025,-71.78307135,42.57127218,-71.7824947,42.57116164,-71.78180482,42.57101422,-71.7808215,42.57091711,-71.78013169,42.57064185,-71.77822344,42.57029738,-71.77586794,42.57020025,-71.77517665,42.57005737,-71.77422048,42.56991531,-71.77326395,42.56982056,-71.77260535,42.56973609,-71.77212164,42.56963842,-71.77164865,42.5695069,-71.77110201,42.56934881,-71.77053484,42.5691594,-71.76998313,42.56894225,-71.76944095,42.568696,-71.7689046,42.56830295,-71.7681293,42.56799168,-71.76758897,42.56738917,-71.76649801,42.56507233,-71.76236974,42.56419378,-71.76077032,42.5621697,-71.75717631,42.56184742,-71.75662194,42.56156437,-71.75619653,42.56128536,-71.75580492,42.56109358,-71.755551,42.56086069,-71.75527056,42.5605462,-71.7549137,42.56020014,-71.75456266,42.5598491,-71.7542335,42.55945416,-71.75389711,42.55903091,-71.75358808,42.55836342,-71.75316116,42.55781891,-71.75284052,42.55765613,-71.75274485,42.55700473,-71.75236626,42.55649148,-71.75204947,42.55415466,-71.75070627,42.5537543,-71.7504601,42.55305404,-71.74996186,42.55216199,-71.74932444,42.55198312,-71.7491842,42.54992592,-71.74756136,42.54827764,-71.74627496,42.5446263,-71.74342565,42.54283117,-71.74201274,42.54074369,-71.74038767,42.54005167,-71.7398585,42.53951225,-71.73944384,42.53951225,-71.73944384,42.53901529,-71.73906201,42.53708232,-71.73753677,42.53528021,-71.73614458,42.5329647,-71.7343443,42.53108233,-71.73286518,42.53102616,-71.73282527,42.53003166,-71.73205661,42.52903803,-71.73125941,42.5287838,-71.73105481,42.52804638,-71.73042812,42.5276772,-71.7300773,42.52734392,-71.72974481,42.5270789,-71.7294478,42.52698908,-71.72935473,42.52631903,-71.72851501,42.52595294,-71.72798616,42.52559045,-71.72743656,42.52527179,-71.72692348,42.52494151,-71.72631911,42.52458369,-71.72562153,42.52425824,-71.72493001,42.52398249,-71.72421864,42.52373873,-71.72356007,42.52351206,-71.72286298,42.52335697,-71.72232158,42.5232243,-71.72182255,42.52286574,-71.7202095,42.52231911,-71.71762876,42.52214541,-71.71675643,42.5220411,-71.71619335,42.52200023,-71.71574659,42.52197327,-71.71534291,42.52197951,-71.71494045,42.52199972,-71.71454917,42.52206847,-71.71402563,42.52210886,-71.71384474,42.52214926,-71.713662,42.52220488,-71.71341291,42.52234645,-71.71297716,42.52249977,-71.71256592,42.52269565,-71.71214147,42.52297806,-71.71166055,42.52326664,-71.71125792,42.5238771,-71.7106976,42.52487066,-71.7101096,42.52751321,-71.70867863,42.52835671,-71.70821398,42.53024668,-71.70718329,42.53089485,-71.70684669,42.53179661,-71.70633655,42.53346349,-71.70544934,42.53352859,-71.70540726,42.53399945,-71.70510419,42.53437421,-71.70482825,42.53461957,-71.70464465,42.53492903,-71.70436887,42.53533255,-71.70396873,42.53567624,-71.70357247,42.53597626,-71.70319982,42.53628989,-71.7027311,42.53651698,-71.70232704,42.53655276,-71.70226333,42.53655441,-71.70226074,42.53659185,-71.70219222,42.53677434,-71.70186889,42.53687698,-71.7017004,42.53804712,-71.69958142,42.53922863,-71.69736703,42.540295,-71.69538857,42.54068452,-71.69464507,42.5409021,-71.69416744,42.5410101,-71.69390507,42.54111488,-71.69360298,42.54136326,-71.69274733,42.54164839,-71.69157565,42.54213761,-71.68943015,42.54221472,-71.68909086,42.54273421,-71.68686341,42.5436105,-71.68317531,42.54372389,-71.68261532,42.54433469,-71.67999653,42.54507557,-71.67679101,42.54519207,-71.67633008,42.54531222,-71.67581684,42.54547033,-71.6750547,42.5455133,-71.67476463,42.54557449,-71.67440077,42.54567138,-71.67346961,42.54580021,-71.67191066,42.54588188,-71.6708737,42.54593209,-71.67013277,42.54594048,-71.6698389,42.54593314,-71.66941806,42.54575399,-71.66561989,42.54575237,-71.6656017,42.54562924,-71.66324202,42.54547779,-71.66009817,42.54546306,-71.6596391,42.54542815,-71.65928352,42.54538653,-71.6590218,42.54535562,-71.65875194,42.54526044,-71.65813014,42.54489969,-71.65605526,42.54481116,-71.65558155,42.54468057,-71.65474518,42.54461714,-71.65416317,42.54458,-71.65320607,42.54457386,-71.65307729,42.54458378,-71.65242533,42.54462972,-71.65192189,42.54471188,-71.65121109,42.54487998,-71.65002256,42.54510858,-71.64830239,42.54513601,-71.64809873,42.54513601,-71.64809873,42.54546483,-71.64565369,42.54553399,-71.64520298,42.5457204,-71.64425417,42.54584588,-71.64374941,42.54598178,-71.64324727,42.54614819,-71.64270326,42.54640416,-71.64183957,42.54665379,-71.64099924,42.54704271,-71.63978664,42.54801956,-71.63657397,42.54846135,-71.63515806,42.54884666,-71.63392979,42.54949417,-71.6318333,42.55023642,-71.62939479,42.55090092,-71.62724034,42.55155992,-71.62506394,42.55212496,-71.62321798,42.55277744,-71.62116915,42.55323256,-71.61968662,42.55347933,-71.61880639,42.55372615,-71.61786084,42.55439371,-71.61518545,42.5549606,-71.6129667,42.5554518,-71.61094559,42.55604014,-71.60859059,42.55682366,-71.60549729,42.55806291,-71.60046757,42.5581122,-71.6002702,42.55819536,-71.59993406,42.55879338,-71.59754769,42.55892676,-71.59685716,42.55901372,-71.59623783,42.5590685,-71.59569453,42.5590929,-71.59505208,42.55910175,-71.59429417,42.55909273,-71.5932382,42.5590834,-71.59152675,42.55906799,-71.59089166,42.55906634,-71.59055427,42.55906165,-71.58988172,42.55905527,-71.58890295,42.55905527,-71.58890295,42.55905112,-71.58823188,42.55903502,-71.58740379,42.55902894,-71.58709312,42.55900798,-71.5865074,42.55896203,-71.58593945,42.55887611,-71.58524155,42.55886113,-71.58509344,42.55883106,-71.58493565,42.5588256,-71.58491003,42.55879443,-71.58474854,42.55874223,-71.58446304,42.55868452,-71.58420872,42.55847578,-71.58336108,42.55815753,-71.58214326,42.55796571,-71.58140923,42.5570719,-71.57799274,42.55700074,-71.57772023,42.55671528,-71.57664131,42.5561493,-71.57440632,42.55600252,-71.57393628,42.55591111,-71.5735795,42.55583476,-71.57325392,42.55574861,-71.57280548,42.55567041,-71.57236298,42.55562342,-71.57204152,42.55554897,-71.57130138,42.55553579,-71.57086267,42.55551029,-71.57038535,42.55550969,-71.57002015,42.55551711,-71.56954286,42.55554756,-71.56909827,42.55559978,-71.56850932,42.55560228,-71.56844178,42.55584533,-71.56572675,42.55598454,-71.56410016,42.55632602,-71.56026804,42.55663783,-71.55683632,42.55672284,-71.55581054,42.55706601,-71.55191115,42.55723061,-71.55011453,42.55753966,-71.54664263,42.55759145,-71.54614977,42.55771858,-71.54452791,42.55784012,-71.5431228,42.55794324,-71.54175739,42.55797379,-71.54074266,42.5579624,-71.54034626,42.55792526,-71.53985668,42.5578897,-71.5395241,42.55781691,-71.53892761,42.55773419,-71.53850555,42.55763966,-71.53809834,42.55754731,-71.53773566,42.55745111,-71.53740157,42.55733708,-71.53702812,42.55714681,-71.5365314,42.55701685,-71.53619618,42.5568441,-71.53582493,42.55668807,-71.53552347,42.55638008,-71.53500406,42.55620456,-71.53473377,42.55591079,-71.53435652,42.55461312,-71.53273988,42.55364402,-71.53154767,42.55275611,-71.53043608,42.55123756,-71.52857827,42.55115362,-71.52845799,42.55104857,-71.52830467,42.55052134,-71.52767317,42.54993184,-71.52694517,42.54937416,-71.52624243,42.54853777,-71.52522378,42.54636706,-71.52252843,42.54571938,-71.52170439,42.54520199,-71.52108228,42.54447255,-71.5201484,42.54366462,-71.51917556,42.5428984,-71.51821278,42.54182052,-71.51687368,42.54061614,-71.51539878,42.53999803,-71.51462647,42.53851379,-71.51274902,42.53815657,-71.51237049,42.53804271,-71.51225025,42.53757053,-71.51179712,42.53706431,-71.51138629,42.53666098,-71.51108977,42.53626972,-71.51084037,42.53597751,-71.51068857,42.53538869,-71.5103653,42.53501635,-71.51018344,42.53325921,-71.50934356,42.53076836,-71.50810369,42.52981844,-71.50764688,42.52858206,-71.50705167,42.52492723,-71.50523985,42.52483009,-71.50519273,42.52475079,-71.50515303,42.52442756,-71.50500833,42.52434635,-71.50496381,42.52431534,-71.50494822,42.52424674,-71.50491075,42.52306715,-71.50433606,42.52095023,-71.50328207,42.51958266,-71.50263287,42.51958266,-71.50263287,42.51928138,-71.50248968,42.51795662,-71.5018164,42.51784796,-71.50176447,42.51777744,-71.5017296,42.51768305,-71.50168509,42.51757164,-71.50163093,42.5171414,-71.50141876,42.51310176,-71.49944959,42.51253047,-71.49915585,42.51221162,-71.49897042,42.5118357,-71.49873083,42.51139913,-71.49842708,42.5104102,-71.49764085,42.50716073,-71.49512803,42.50395758,-71.49267407,42.50387279,-71.49260918,42.50210065,-71.49125586,42.50057354,-71.4900739,42.49893665,-71.48883862,42.49800365,-71.48828369,42.49723392,-71.48783628,42.49527461,-71.48669759,42.49476392,-71.48640256,42.49385698,-71.48590331,42.49382378,-71.48588033,42.49349256,-71.48568055,42.49224863,-71.48497044,42.49130682,-71.48439672,42.49048247,-71.48393681,42.48965372,-71.48345207,42.48930713,-71.48320895,42.48800002,-71.48219086,42.48574635,-71.48022216,42.48512009,-71.47969259,42.48441505,-71.47909076,42.48361753,-71.47840371,42.48247254,-71.47736425,42.48185147,-71.47680247,42.48175322,-71.47671317,42.48117853,-71.47622739,42.48058875,-71.47574125,42.4800717,-71.47535481,42.47941415,-71.47490875,42.47887325,-71.47459943,42.47810704,-71.47418717,42.47707765,-71.47366159,42.47692726,-71.47358084,42.47651726,-71.47335824,42.47608861,-71.47317679,42.4758312,-71.47306495,42.47556556,-71.47297499,42.47473598,-71.47262729,42.47391984,-71.47229442,42.47231142,-71.47159237,42.47033225,-71.47074597,42.46993048,-71.47056195,42.46937175,-71.47032759,42.4682035,-71.46981667,42.46730283,-71.46944166,42.46694195,-71.4692732,42.46620566,-71.46896076,42.46569521,-71.46872011,42.46565871,-71.46870345,42.46534064,-71.46853869,42.46486832,-71.46824651,42.46451811,-71.46799171,42.46397166,-71.46754541,42.46364202,-71.46721945,42.4633862,-71.46695608,42.46299148,-71.46647266,42.46258933,-71.46593365,42.462345,-71.46555726,42.46209022,-71.46511565,42.46180661,-71.46457919,42.46163911,-71.46422315,42.46146776,-71.4638067,42.46120493,-71.46308976,42.46098189,-71.46237058,42.46090852,-71.46205637,42.46083103,-71.46171844,42.46075078,-71.46133938,42.46065151,-71.46072093,42.46057307,-71.46005059,42.46045771,-71.45893669,42.46034154,-71.45790543,42.4603319,-71.45781391,42.4603319,-71.45781391,42.46027793,-71.45729883,42.46017413,-71.45636281,42.46012591,-71.45583328,42.46010356,-71.45550496,42.46007028,-71.45460966,42.46006942,-71.45452072,42.46006942,-71.45450145,42.46006746,-71.4544051,42.46004762,-71.4535135,42.46004112,-71.45305287,42.4600303,-71.45275678,42.4599635,-71.45050666,42.45992752,-71.44980036,42.45989604,-71.44933939,42.45983073,-71.44872464,42.4596724,-71.44750223,42.45958928,-71.44693939,42.45947953,-71.44637843,42.45935717,-71.44584675,42.45920626,-71.44528138,42.45912327,-71.44501909,42.45892268,-71.44443709,42.45872541,-71.44392809,42.45830537,-71.44293459,42.45797984,-71.44219968,42.4576389,-71.44138066,42.45727516,-71.44054463,42.4569548,-71.43974748,42.45679762,-71.43931444,42.45676573,-71.43921331,42.45669511,-71.4390281,42.45630344,-71.43780822,42.45613984,-71.43718288,42.45581037,-71.43583809,42.45577376,-71.43563728,42.4556568,-71.43503821,42.45553954,-71.4343932,42.4554528,-71.43385932,42.45538225,-71.43332876,42.45531332,-71.43275595,42.45524874,-71.43213386,42.45518955,-71.43134243,42.45515236,-71.43018486,42.45514296,-71.429622,42.45514894,-71.42907913,42.45516371,-71.42855441,42.45521498,-71.42760648,42.45527954,-71.42685789,42.45534419,-71.4262527,42.45545661,-71.42528171,42.45551777,-71.42481214,42.45586081,-71.42198179,42.45600149,-71.42064724,42.4560136,-71.4203115,42.45602494,-71.41964522,42.45602193,-71.41925762,42.45599111,-71.41874406,42.45581429,-71.41667695,42.45566862,-71.41485438,42.45559585,-71.41403518,42.45550575,-71.41281877,42.4553448,-71.41082541,42.45522675,-71.4093504,42.45522315,-71.40930483,42.45521872,-71.40924703,42.45505045,-71.407114,42.45498458,-71.40607322,42.45494342,-71.40573534,42.45491877,-71.40512656,42.45493242,-71.40438284,42.45497896,-71.4035946,42.45503017,-71.40314208,42.45520058,-71.40217319,42.45553931,-71.40039326,42.45567949,-71.39972307,42.45593844,-71.39837383,42.45611139,-71.39753831,42.45638484,-71.39616643,42.45666597,-71.3948123,42.45672004,-71.39452799,42.45684456,-71.39386633,42.45684456,-71.39386633,42.45705973,-71.392725,42.45710832,-71.39245663,42.45723968,-71.39178753,42.45736725,-71.3911807,42.45748523,-71.39058277,42.45787464,-71.38862178,42.45796649,-71.38797794,42.45800184,-71.38764696,42.45804413,-71.38711771,42.45809263,-71.38649432,42.45811443,-71.38606442,42.45811854,-71.38577685,42.45811938,-71.38496827,42.4581038,-71.38447766,42.45809014,-71.38317809,42.45805723,-71.38158878,42.45805547,-71.38146946,42.45805175,-71.38132383,42.45804972,-71.38121785,42.45796232,-71.37614047,42.45792515,-71.37449447,42.45789522,-71.37248271,42.45781838,-71.36832582,42.45777843,-71.36604209,42.45775929,-71.36492672,42.45770076,-71.362311,42.45767251,-71.36163589,42.45761827,-71.36102235,42.45756595,-71.36064596,42.45749881,-71.36026221,42.45742071,-71.35990033,42.45732066,-71.35953481,42.45718897,-71.35910413,42.45705959,-71.35876869,42.45697811,-71.3585595,42.45681192,-71.35818709,42.45667468,-71.35792912,42.45667468,-71.35792912,42.45661994,-71.35782659,42.45620028,-71.35707197,42.45603421,-71.35680628,42.45591462,-71.35662498,42.4557398,-71.3563797,42.45559689,-71.35620104,42.45511687,-71.35568818,42.45470566,-71.35534154,42.45450517,-71.35520008,42.45421162,-71.35502993,42.45389419,-71.35485465,42.4527344,-71.35427409,42.45198814,-71.35392565,42.45146397,-71.35366082,42.4508506,-71.3533736,42.4495917,-71.35276405,42.44825727,-71.35210432,42.44594896,-71.35099933,42.44547835,-71.35077926,42.44540861,-71.35074311,42.44531415,-71.35069295,42.44524276,-71.35065347,42.44504587,-71.35054687,42.44480064,-71.35040184,42.44432993,-71.3500973,42.44377075,-71.34971851,42.44319092,-71.34928198,42.44268716,-71.34889121,42.44177457,-71.3481028,42.44106634,-71.34748137,42.44040892,-71.34689355,42.43959873,-71.34616051,42.43725368,-71.34409986,42.43493077,-71.34200782,42.4314239,-71.33882806,42.43082085,-71.33829806,42.43056758,-71.33810646,42.43025445,-71.33788354,42.42994486,-71.33764024,42.42877659,-71.33676169,42.4283099,-71.33642361,42.42821733,-71.33635644,42.42814591,-71.33630477,42.42777124,-71.33603276,42.42657604,-71.33513508,42.42555222,-71.33435366,42.4248688,-71.33385655,42.42372274,-71.33299364,42.4215499,-71.33139648,42.42038597,-71.33051927,42.41975278,-71.33005433,42.41970526,-71.33001964,42.41739693,-71.32831714,42.41611957,-71.32738369,42.41516001,-71.32667344,42.4141994,-71.32599174,42.4140255,-71.3258589,42.41390462,-71.32576629,42.41390462,-71.32576629,42.41326892,-71.32527886,42.41253299,-71.32475321,42.41144649,-71.32394231,42.40934138,-71.32240076,42.40878038,-71.32196688,42.40809097,-71.32154559,42.40757302,-71.32127194,42.40735719,-71.32117406,42.40699068,-71.32105365,42.40652184,-71.3209513,42.40603632,-71.32088677,42.40553193,-71.32086302,42.40513624,-71.32086414,42.40487092,-71.32088266,42.4046517,-71.32089921,42.4043603,-71.32091188,42.40430432,-71.32091093,42.40412957,-71.3209403,42.4038837,-71.32093508,42.40354229,-71.32090457,42.40336855,-71.32087729,42.40309955,-71.32081919,42.4026581,-71.32068604,42.40210261,-71.32044807,42.40191201,-71.32033939,42.40163099,-71.32014655,42.40135352,-71.31994186,42.4010271,-71.31966733,42.40068958,-71.3193125,42.40048531,-71.31906429,42.40019137,-71.31868305,42.39999415,-71.3183841,42.39970822,-71.31786327,42.3995587,-71.31753568,42.39945155,-71.31727979,42.39936116,-71.31703348,42.39922422,-71.31668401,42.39914366,-71.31640917,42.39904671,-71.31601516,42.39893379,-71.31558381,42.3987481,-71.31477541,42.39852294,-71.31383237,42.39774532,-71.31066227,42.39725256,-71.30855167,42.39707936,-71.30786212,42.3969341,-71.30730724,42.39681301,-71.30677266,42.39662734,-71.30601355,42.39617858,-71.30416981,42.39607473,-71.30377327,42.39573894,-71.30237752,42.39572375,-71.30232019,42.39570332,-71.30224806,42.39566906,-71.3021112,42.3954126,-71.30105877,42.39526605,-71.30041249,42.39512979,-71.29985391,42.39492076,-71.29909973,42.39477923,-71.2986689,42.39459311,-71.2981538,42.39430682,-71.29748133,42.39396517,-71.29684532,42.39374,-71.29644697,42.39358289,-71.296205,42.39342196,-71.29597933,42.39319696,-71.29567724,42.39298794,-71.29540879,42.39281826,-71.29520351,42.39279874,-71.29517729,42.39277097,-71.29514962,42.3926577,-71.29502634,42.39227202,-71.29463927,42.39199083,-71.29437587,42.39176244,-71.29417227,42.39101273,-71.29353764,42.39081294,-71.29337356,42.38935306,-71.29212716,42.38883725,-71.29171057,42.38809577,-71.29108189,42.38714462,-71.29029438,42.38632617,-71.28959751,42.38583364,-71.28916274,42.3857424,-71.28908902,42.3857424,-71.28908902,42.38515816,-71.28861829,42.38451638,-71.2880519,42.38340992,-71.28712547,42.38293057,-71.28670291,42.38260038,-71.28636017,42.38221819,-71.28594914,42.38142269,-71.28506614,42.38064419,-71.28418198,42.37999336,-71.28348098,42.37976373,-71.2832164,42.37940871,-71.28281198,42.37940871,-71.28281198,42.37927452,-71.28265921,42.37897728,-71.28234157,42.37881834,-71.28216188,42.37836381,-71.28166972,42.37765202,-71.28081059,42.37741981,-71.28049052,42.37695418,-71.27979265,42.37631051,-71.27868943,42.37557629,-71.27731712,42.37553248,-71.27722475,42.37520185,-71.27667079,42.37496387,-71.27620902,42.37460891,-71.27556967,42.37453126,-71.27543079,42.37435314,-71.27513684,42.37393958,-71.27455803,42.37377181,-71.27436507,42.37353945,-71.2741161,42.37330224,-71.27391119,42.37295757,-71.27362524,42.37271134,-71.27343887,42.37239562,-71.27322129,42.37109491,-71.2723774,42.37035083,-71.27187421,42.36965403,-71.27142045,42.36959246,-71.27136775,42.3695139,-71.27132696,42.36928199,-71.27117164,42.3692427,-71.27114551,42.36920259,-71.27112271,42.36889569,-71.27092436,42.36825958,-71.27049519,42.36808016,-71.27037928,42.36752709,-71.27003049,42.36731303,-71.26988362,42.36714514,-71.26977137,42.36702479,-71.26969114,42.36686321,-71.26957295,42.36661864,-71.26940325,42.36642522,-71.26928111,42.36567668,-71.26875654,42.36511095,-71.26839561,42.3648941,-71.26822361,42.36462803,-71.26799998,42.36443803,-71.26780937,42.3640753,-71.26742292,42.36394408,-71.26726097,42.36365181,-71.26683689,42.36345073,-71.26646502,42.36334521,-71.26625524,42.36312942,-71.26579944,42.36292063,-71.26527628,42.36278179,-71.2648757,42.36263487,-71.26441965,42.36245885,-71.2638231,42.362139,-71.26254148,42.36209125,-71.26227488,42.36201395,-71.261917,42.36195166,-71.26152096,42.36193258,-71.2613153,42.36191379,-71.26086026,42.36191269,-71.26072448,42.36191596,-71.26058275,42.36190809,-71.26023053,42.36190809,-71.26023053,42.36190809,-71.26022942,42.36191031,-71.26010805,42.36191453,-71.25989676,42.36193259,-71.25960809,42.36200072,-71.25899028,42.36206494,-71.25860338,42.36215245,-71.25819677,42.36226457,-71.25775566,42.36239461,-71.25734889,42.36257198,-71.25687719,42.36271283,-71.25652957,42.3628511,-71.25625523,42.36299951,-71.25597567,42.36314769,-71.25571461,42.36349911,-71.25502835,42.3639711,-71.25413033,42.36426484,-71.25355121,42.36433751,-71.25339811,42.36472259,-71.25267099,42.36506603,-71.25198362,42.36554873,-71.25109994,42.36684505,-71.24858969,42.36715397,-71.24805857,42.36751635,-71.24750909,42.36780066,-71.24714532,42.3681091,-71.24677626,42.3682096,-71.24668335,42.3683687,-71.24653247,42.36864249,-71.24625162,42.3689377,-71.24598104,42.36917867,-71.24575064,42.36950948,-71.24544882,42.36956454,-71.24540198,42.36999401,-71.24504314,42.3702974,-71.24474995,42.37046445,-71.2445957,42.37072835,-71.24431561,42.37113805,-71.2438288,42.37141632,-71.24346834,42.37158315,-71.2432175,42.37191424,-71.24267327,42.37219189,-71.24216255,42.37262325,-71.24130519,42.37304589,-71.240352,42.37332336,-71.23964402,42.3735818,-71.23889799,42.37375236,-71.23835919,42.37377005,-71.23829658,42.37384075,-71.23801243,42.3739078,-71.237695,42.37402823,-71.23695915,42.37409584,-71.23652514,42.37422058,-71.23575781,42.37429473,-71.23530378,42.37429473,-71.23530378,42.37445167,-71.23434498,42.37460832,-71.23349721,42.37480707,-71.23235244,42.37502325,-71.23115319,42.37504284,-71.23107872,42.37505068,-71.23103057,42.37527613,-71.22992787,42.37555054,-71.22876462,42.37557014,-71.22869718,42.37558587,-71.22862013,42.37572962,-71.22802108,42.37590346,-71.22761767,42.37612119,-71.22708935,42.37657871,-71.22608997,42.37699194,-71.22527101,42.3775204,-71.22421948,42.37765097,-71.22397391,42.3777848,-71.2237124,42.37791853,-71.22340907,42.37810048,-71.22307185,42.37893922,-71.22143378,42.37926305,-71.22076653,42.37958668,-71.22013073,42.37982331,-71.21960671,42.37991797,-71.21937793,42.38020431,-71.2184225,42.38055416,-71.21718327,42.38072726,-71.21660696,42.38108066,-71.21536843,42.38121408,-71.21484041,42.38130038,-71.21445435,42.38160145,-71.21303579,42.38204114,-71.21110247,42.38212665,-71.21073343,42.38248779,-71.20899846,42.38267181,-71.2081974,42.38278285,-71.20773052,42.38291523,-71.20712918,42.38329139,-71.20549774,42.3841388,-71.20241942,42.38453518,-71.20099436,42.3846648,-71.20050331,42.38512137,-71.19891137,42.38582576,-71.19640322,42.38608698,-71.19546105,42.38636511,-71.19448584,42.38678336,-71.19295989,42.38689024,-71.19259995,42.38701297,-71.19221624,42.38716161,-71.1917754,42.38733058,-71.19134075,42.38737304,-71.19121062,42.38743685,-71.1910615,42.38757014,-71.19072734,42.38757014,-71.19072734,42.38762165,-71.1905979,42.38769697,-71.19044355,42.38776986,-71.19030364,42.38793911,-71.18997485,42.38833798,-71.18922146,42.38902148,-71.18798877,42.38935396,-71.18734415,42.38979458,-71.18651241,42.39071657,-71.18479984,42.39111347,-71.18403825,42.39152062,-71.18331399,42.39183362,-71.18278343,42.39200138,-71.18251828,42.3921867,-71.18225636,42.39253751,-71.18180371,42.39308102,-71.1811772,42.39354395,-71.18068584,42.39374098,-71.18049012,42.39432313,-71.17994743,42.39437732,-71.17989644,42.39469476,-71.17958349,42.39486326,-71.17939273,42.39502049,-71.17919239,42.3951484,-71.17900812,42.39531689,-71.17871739,42.39547711,-71.17841116,42.39558422,-71.17814851,42.39571957,-71.17778131,42.39582278,-71.17740206,42.39589127,-71.17706779,42.39590174,-71.17698592,42.39593231,-71.17673328,42.39597625,-71.17625475,42.39600357,-71.17582405,42.39601829,-71.17559445,42.39601796,-71.17547783,42.39601696,-71.17541453,42.39601696,-71.17541453,42.39599457,-71.17390086,42.39599018,-71.1711047,42.39598108,-71.16917448,42.39596231,-71.16694814,42.39595294,-71.1652319,42.39593779,-71.16436384,42.39591823,-71.16041049,42.39589208,-71.15880466,42.39588577,-71.1578814,42.39588451,-71.15626211,42.39585967,-71.15483805,42.39583363,-71.15448095,42.39579588,-71.1540643,42.3957448,-71.15368697,42.39568127,-71.1532749,42.39561875,-71.15292429,42.39550035,-71.15233594,42.39503577,-71.15042973,42.39497525,-71.15019905,42.39491841,-71.15000723,42.39475583,-71.14951169,42.39464354,-71.14922393,42.39450625,-71.14892409,42.39415661,-71.14819155,42.394023,-71.14793131,42.39395833,-71.14778137,42.39346621,-71.14676015,42.39324173,-71.14621685,42.39308621,-71.1457957,42.39294608,-71.14537817,42.39280101,-71.14487441,42.39268368,-71.14437865,42.39258751,-71.1438935,42.39237004,-71.14269643,42.39211598,-71.14120971,42.39210142,-71.14111725,42.3920888,-71.14103181,42.39196427,-71.14025475,42.39185811,-71.13965195,42.39172832,-71.1388679,42.3916294,-71.13829986,42.39155019,-71.13780649,42.39149756,-71.13747511,42.39135966,-71.13673183,42.39112359,-71.13531947,42.39099755,-71.13459797,42.39085293,-71.13373444,42.39068073,-71.13273892,42.39067234,-71.13268973,42.39056604,-71.13205698,42.39042513,-71.13115642,42.39026929,-71.13030629,42.39009025,-71.12924345,42.38997654,-71.12853264,42.38982511,-71.12769472,42.38970047,-71.12691513,42.38938978,-71.12503835,42.38934428,-71.1248006,42.38933061,-71.12473108,42.38931358,-71.12464234,42.38929823,-71.12456433,42.38917183,-71.12384029,42.38902705,-71.12286501,42.38890344,-71.12215799,42.38860172,-71.12036152,42.38853303,-71.1200025,42.38844904,-71.11966468,42.38844904,-71.11966468,42.38844904,-71.11966431,42.38841902,-71.11954789,42.38838398,-71.11940854,42.38829807,-71.11906888,42.38819134,-71.11882669,42.38810699,-71.11862769,42.38786392,-71.1181472,42.3874284,-71.11739137,42.38706915,-71.1167987,42.38681714,-71.11635789,42.38674289,-71.11622731,42.38668355,-71.11612329,42.38641309,-71.11566075,42.38561186,-71.11428016,42.38489605,-71.11308747,42.38418296,-71.11197401,42.38417854,-71.11196553,42.38306153,-71.11021054,42.38277922,-71.10973999,42.38255938,-71.10932421,42.38215749,-71.10846984,42.3818454,-71.10763788,42.3816403,-71.10704177,42.38140937,-71.10619229,42.38115981,-71.10519525,42.38096383,-71.10438146,42.38094573,-71.10430459,42.38092568,-71.10422181,42.38061293,-71.10288763,42.3800424,-71.10049841,42.37991591,-71.10002916,42.37979804,-71.09966941,42.3796425,-71.09929066,42.37954094,-71.09904629,42.37944699,-71.09885813,42.37937329,-71.09873498,42.37930622,-71.09862215,42.37906311,-71.09815513,42.37867043,-71.09744961,42.37791054,-71.09602325,42.37783901,-71.09589269,42.37781913,-71.09585692,42.37771887,-71.09567362,42.37751259,-71.09530261,42.37746677,-71.09522704,42.37742482,-71.09515772,42.37711985,-71.0945838,42.37692757,-71.09414055,42.37671531,-71.09363339,42.37654624,-71.09315743,42.37638318,-71.0926755,42.37631805,-71.09241537,42.37625932,-71.09218,42.37612535,-71.09154652,42.376068,-71.09123786,42.37603274,-71.09104342,42.37593933,-71.09039525,42.37580428,-71.08922923,42.37574302,-71.08875147,42.37561361,-71.0877068,42.37553935,-71.0871255,42.37549098,-71.08679792,42.37546088,-71.08659382,42.37539136,-71.08588038,42.37537224,-71.08575208,42.37535829,-71.08561265,42.37524944,-71.08480102,42.37515724,-71.08396522,42.37500746,-71.08268866,42.37499205,-71.08260253,42.37497467,-71.08250161,42.37495915,-71.08238403,42.37494699,-71.08228308,42.37493342,-71.08217399,42.37491796,-71.08207306,42.37487096,-71.0816733,42.37483368,-71.08145816,42.37477209,-71.08119803,42.37468646,-71.08089438,42.37460358,-71.08066548,42.37455485,-71.08054701,42.37447818,-71.08029031,42.37442946,-71.08009818,42.37434334,-71.07966021,42.37431575,-71.07947054,42.37423565,-71.07872609,42.37394371,-71.07619483,42.3738631,-71.0755418,42.37375614,-71.07459327,42.37374248,-71.07423771,42.3737392,-71.07387098,42.37372499,-71.07314757,42.37368464,-71.07284771,42.37363287,-71.07257864,42.37360846,-71.07250701,42.37355436,-71.0723475,42.37347704,-71.07214485,42.37337479,-71.07194977,42.37302272,-71.07143516,42.37290448,-71.0712957,42.37252396,-71.07080312,42.37240381,-71.07059225,42.37236708,-71.07053033,42.37230965,-71.0704345,42.37227569,-71.07037922,42.3720622,-71.07001319,42.37188557,-71.06966838,42.3717527,-71.06943355,42.37146536,-71.0690584,42.37143227,-71.06901422,42.37141682,-71.06899249,42.37139721,-71.06896006,42.37107024,-71.06848046,42.3703894,-71.06752036,42.37027376,-71.06734463,42.37015086,-71.06713491,42.36996601,-71.06679757,42.36986498,-71.06663951,42.36982993,-71.06658572,42.36978328,-71.06651388,42.36958714,-71.06623879,42.36956562,-71.06620896,42.36953337,-71.06616848,42.36951019,-71.06613496,42.36925747,-71.06577515,42.36905588,-71.06550973,42.36889823,-71.06525584,42.36866907,-71.06495842,42.36851033,-71.06470603,42.36834561,-71.06446811,42.3682433,-71.06433411,42.36813415,-71.06420757,42.36766122,-71.06374087,42.36672108,-71.0627945,42.36646765,-71.06253945,42.36643101,-71.0625027 
				}
			};

		return results;

	}

	/* maybe this should be part of a separate class, since we are only doing this to improve performance on map. */
	public double[] getReducedLinePath(String lineid) {
		return new double[3];
	}

	public double[] getClosedPoly(String lineid) {
		return new double[3];
	}

}